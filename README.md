# CATH / UniProtKB

**Note:** this repo currently contains at least one large data file (~70MB). This may get moved over to [Git LFS](https://git-lfs.github.com/) at some point in the future.

This project has been created to help various aspects of integrating CATH FunFams and UniProtKB, including:

 * Choosing suitable names for CATH FunFams (based on UniProtKB annotations)
 * Mapping UniProtKB entries to CATH FunFams
 * Requirements for linking between web sites

This is intended to be a working document, please feel free to suggest changes - ideally by [adding issues](https://github.com/sillitoe/cath-funfam-uniprot/issues) or [pull requests](https://help.github.com/articles/github-flow/), however [emails](mailto:i.sillitoe@ucl.ac.uk) work pretty well too.

## Mapping Between CATH and UniProtKB

This repository contains data files that map between the latest official release of CATH (v4.1) and UniProtKB. These data are generally formatted as tab-separated text files with some automatically generated meta data in the headers.

### FunFam Names

List of all the FunFam names as they currently stand in CATH v4.1.

```
./data/funfam_names.v4_1_0.tsv.gz
```

e.g.

```
> zcat ./data/funfam_names.v4_1_0.tsv.gz | head
# FILE            funfam_names.v4_1_0.tsv
# DESCRIPTION     Create a list of the FunFam names in CATH v4_1_0
# CREATED_BY      ucbcisi
# GENERATED       Thu Mar  2 21:31:49 2017
# HOSTNAME        bsmlx53
# GIT_LAST_COMMIT 705343229e07c02aa26dbce4a426de91d4e495eb (Thu Mar 2 21:22:13 2017 +0000)
# FORMAT          FUNFAM_ID     NAME
1.10.10.10/FF/56                Putative replication protein C
1.10.10.10/FF/481               ATP-dependent DNA helicase Q-like SIM
1.10.10.10/FF/1225              DEP domain-containing protein 7
```

### FunFam to UniProtKB sequences

Provides a mapping of all the domains found in CATH FunFams to their 
UniProtKB entries.

```
./data/funfam_uniprot_mapping.v4_1_0.tsv.gz
```

e.g.

```
> zcat ./data/funfam_uniprot_mapping.v4_1_0.tsv.gz | head
# FILE            funfam_uniprot_mapping.v4_1_0.tsv
# DESCRIPTION     Create a mapping between uniprot accessions
# CREATED_BY      ucbcisi
# GENERATED       Thu Mar  2 20:59:30 2017
# HOSTNAME        bsmlx53
# GIT_LAST_COMMIT 03fcbdb073cefc8dca53d21e552d6acf6781cdc8 (Thu Mar 2 19:44:55 2017 +0000)
# FORMAT          FUNFAM_ID     MEMBER_ID       UNIPROT_ACC     DESCRIPTION
1.10.10.10/FF/56        c590ded82159d8d59d18c6f2885a5761/40-172_215-246 P55391          Putative replication protein C
1.10.10.10/FF/481       5ad1400176f956f6ff45a16115a61803/601-780        Q9FT69          ATP-dependent DNA helicase Q-like SIM
1.10.10.10/FF/481       67283d4022905118dc23abda563d6a19/600-777        D7M5J3          Predicted protein
```

### (Re-)Generating this data

These data files were generated by a script in this repo. Due to local requirements, the script can only be run within UCL - it has been added here 
for reference.

```
./script/generate_data.pl
```
   
## FunFam Naming Protocol

The protocol responsible for assigning names to FunFams in CATH v4.1 was 
designed to meet the following objectives:

 * Assigning names must be completely automated
 * An ideal name will be:
    1. biologically meaningful
    1. unique
    1. representative of all the sequences in a cluster
 * Procedure should be simple and reproducible
 
### Original protocol (CATH v4.1)

The intention was to select an existing UniProtKB description that best 
represented the cluster as a whole, but was still as specific as possible. 
We tried to do this by finding the description that contained terms that
were popular in this cluster.

The following protocol is far from perfect, however it gave names that looked
reasonably distinct and sensible.

#### FOREACH FunFam

 1. Associate a UniProtKB description for each member sequence
 * Split descriptions into individual "terms"
 * Normalise "terms" (lowercase, remove common words, etc)
 * Generate running total of how often each term occurs in the entire FunFam
 * Score each description based on the cumulative scores for the terms it contains
 * Normalise each description score based on number of words (descriptions are penalised as they go further away from 6-8 words)
 * Select the description with the highest overall score to represent the cluster

#### Notes

 * CATH sequences are identified by an MD5 (based on their amino acid sequence)
 * UniProtKB may have many entries with the same sequence (ie CATH to UniProtKB is a one-to-many relationship)
 * For each CATH sequence, the protocol takes the description from the first UniProtKB entry it finds (chosen effectively arbitrary)
 * That assumes that UniProtKB descriptions are identical for identical sequences, however that definitely does not appear to be the case
 
#### Improvements?
 
 * Are we using the best description for each UniProtKB entry? (currently based on ```DE RecName: Full=<Description>;```)
 * Which UniProtKB entry should we use to represent each unique sequence in CATH? (eg should we prefer annotations from certain model organisms?)
 * ...?
 
## FAQ

### What is a FunFam?

A FunFam (Functional Family) is a collection of protein domains within a Homologous Superfamily in CATH that have been predicted to
perform the similar function. These domains can come from one of two sources:

 * **CATH**: sequences from known PDB structures that have been manually chopped into structural domains
 * **Gene3D**: sequences of predicted structural domains

Both of these types of domain (PDB and predicted) can be mapped to a location on a protein sequence in UniProtKB. 

### Distribution of FunFams

The most recent version of CATH contains more than 100,000 FunFam clusters, although many of these clusters only contain a small number of sequences. 
A subset of around 30,000 of these FunFams have a high information content and have been "frozen" ie there is sufficient overall sequence diversity within 
the cluster to provide meaningful information on conserved positions.


